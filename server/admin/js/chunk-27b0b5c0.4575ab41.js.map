{"version":3,"sources":["webpack:///./src/views/Product.vue?c2fa","webpack:///./src/views/Product.vue?a3ba","webpack:///src/views/Product.vue","webpack:///./src/views/Product.vue?6575","webpack:///./src/views/Product.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","_v","_s","id","attrs","on","$event","preventDefault","saveProduct","apply","arguments","model","value","product","callback","$$v","$set","expression","_l","item","key","staticClass","uploadUrl","getAuthHeaders","handleImageUpload","image","length","img","index","ref","$imgAdd","staticRenderFns","name","components","mavonEditor","props","price","description","category","url","fixedCategories","methods","_id","$http","put","post","$message","type","message","$router","push","error","console","res","get","data","response","file","fileList","log","map","pos","$file","formData","FormData","append","then","$refs","mavon","$img2Url","fetchProduct","$route","params","component"],"mappings":"kHAAA,W,kECAA,IAAIA,EAAS,WAAa,IAAIC,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACA,EAAG,KAAK,CAACJ,EAAIM,GAAGN,EAAIO,GAAGP,EAAIQ,GAAK,OAAS,WAAWJ,EAAG,UAAU,CAACK,MAAM,CAAC,cAAc,SAASC,GAAG,CAAC,OAAS,SAASC,GAAgC,OAAxBA,EAAOC,iBAAwBZ,EAAIa,YAAYC,MAAM,KAAMC,cAAc,CAACX,EAAG,eAAe,CAACK,MAAM,CAAC,MAAQ,SAAS,CAACL,EAAG,YAAY,CAACY,MAAM,CAACC,MAAOjB,EAAIkB,QAAgB,SAAEC,SAAS,SAAUC,GAAMpB,EAAIqB,KAAKrB,EAAIkB,QAAS,WAAYE,IAAME,WAAW,qBAAqBtB,EAAIuB,GAAIvB,EAAmB,iBAAE,SAASwB,GAAM,OAAOpB,EAAG,YAAY,CAACqB,IAAID,EAAKf,MAAM,CAAC,MAAQe,EAAK,MAAQA,QAAU,IAAI,GAAGpB,EAAG,eAAe,CAACK,MAAM,CAAC,MAAQ,SAAS,CAACL,EAAG,WAAW,CAACY,MAAM,CAACC,MAAOjB,EAAIkB,QAAY,KAAEC,SAAS,SAAUC,GAAMpB,EAAIqB,KAAKrB,EAAIkB,QAAS,OAAQE,IAAME,WAAW,mBAAmB,GAAGlB,EAAG,eAAe,CAACK,MAAM,CAAC,MAAQ,SAAS,CAACL,EAAG,WAAW,CAACK,MAAM,CAAC,KAAO,UAAUO,MAAM,CAACC,MAAOjB,EAAIkB,QAAa,MAAEC,SAAS,SAAUC,GAAMpB,EAAIqB,KAAKrB,EAAIkB,QAAS,QAASE,IAAME,WAAW,oBAAoB,GAAGlB,EAAG,eAAe,CAACK,MAAM,CAAC,MAAQ,SAAS,CAACL,EAAG,YAAY,CAACsB,YAAY,kBAAkBjB,MAAM,CAAC,OAAST,EAAI2B,UAAU,QAAU3B,EAAI4B,iBAAiB,kBAAiB,EAAK,UAAW,EAAK,aAAa5B,EAAI6B,kBAAkB,MAAQ,IAAI,CAAE7B,EAAIkB,QAAQY,OAAS9B,EAAIkB,QAAQY,MAAMC,OAAQ3B,EAAG,MAAM,CAACsB,YAAY,iBAAiB1B,EAAIuB,GAAIvB,EAAIkB,QAAa,OAAE,SAASc,EAAIC,GAAO,OAAO7B,EAAG,MAAM,CAACqB,IAAIQ,EAAMP,YAAY,iBAAiBjB,MAAM,CAAC,IAAMuB,QAAS,GAAG5B,EAAG,IAAI,CAACsB,YAAY,yCAAyC,GAAGtB,EAAG,eAAe,CAACK,MAAM,CAAC,MAAQ,SAAS,CAACL,EAAG,WAAW,CAACY,MAAM,CAACC,MAAOjB,EAAIkB,QAAW,IAAEC,SAAS,SAAUC,GAAMpB,EAAIqB,KAAKrB,EAAIkB,QAAS,MAAOE,IAAME,WAAW,kBAAkB,GAAGlB,EAAG,eAAe,CAACK,MAAM,CAAC,MAAQ,SAAS,CAACL,EAAG,eAAe,CAAC8B,IAAI,QAAQzB,MAAM,CAAC,WAAa,kBAAkB,QAAS,GAAMC,GAAG,CAAC,OAASV,EAAImC,SAASnB,MAAM,CAACC,MAAOjB,EAAIkB,QAAmB,YAAEC,SAAS,SAAUC,GAAMpB,EAAIqB,KAAKrB,EAAIkB,QAAS,cAAeE,IAAME,WAAW,0BAA0B,GAAGlB,EAAG,eAAe,CAACA,EAAG,YAAY,CAACK,MAAM,CAAC,KAAO,UAAU,cAAc,UAAUC,GAAG,CAAC,MAAQV,EAAIa,cAAc,CAACb,EAAIM,GAAG,WAAW,IAAI,IAAI,IACxmE8B,EAAkB,G,YCoEP,G,UAAA,CACbC,KAAM,cACNC,WAAY,CACVC,YAAA,kBAEFC,MAAO,CACLhC,GAAI,IAEN,OACE,MAAO,CACLU,QAAS,CACPmB,KAAM,GACNI,MAAO,EACPX,MAAO,GACPY,YAAa,GACbC,SAAU,GACVC,IAAK,IAEPC,gBAAiB,CAAC,MAAO,MAAO,KAAM,OAAQ,QAGlDC,QAAS,CACP,oBACE,IACM7C,KAAKiB,QAAQ6B,UACT9C,KAAK+C,MAAMC,IAAI,aAAahD,KAAKiB,QAAQ6B,IAAO9C,KAAKiB,eAErDjB,KAAK+C,MAAME,KAAK,YAAajD,KAAKiB,SAI1CjB,KAAKkD,SAAS,CACZC,KAAM,UACNC,QAAS,SAIXpD,KAAKqD,QAAQC,KAAK,kBAClB,MAAOC,GAEPvD,KAAKkD,SAAS,CACZC,KAAM,QACNC,QAAS,cAIXI,QAAQD,MAAM,aAAcA,KAGhC,mBAAmBhD,GACjB,GAAIA,EAAI,CACN,MAAMkD,QAAYzD,KAAK+C,MAAMW,IAAI,aAAanD,GAC9CP,KAAKiB,QAAUwC,EAAIE,OAIvB,kBAAkBC,EAAUC,EAAMC,GAChCN,QAAQO,IAAIF,EAAKD,UACbC,EAAKD,UAAYC,EAAKD,SAASjB,IACjC3C,KAAKiB,QAAQY,MAAQiC,EAASE,IAAKH,GAASA,EAAKD,SAASjB,KAE1Da,QAAQD,MAAM,wBAIlB,QAAQU,EAAKC,GACX,MAAMC,EAAW,IAAIC,SACrBD,EAASE,OAAO,OAAQH,GACxBlE,KAAK+C,MAAME,KAAK,UAAWkB,GAAUG,KAAMb,IACzCzD,KAAKuE,MAAMC,MAAMC,SAASR,EAAKR,EAAIE,KAAKhB,SAI9C,UACE3C,KAAK0E,aAAa1E,KAAK2E,OAAOC,OAAOrE,IACrCiD,QAAQO,IAAI/D,KAAK2E,OAAOC,OAAOrE,OChJwR,I,wBCQvTsE,EAAY,eACd,EACA/E,EACAqC,GACA,EACA,KACA,WACA,MAIa,aAAA0C,E","file":"js/chunk-27b0b5c0.4575ab41.js","sourcesContent":["export * from \"-!../../node_modules/.pnpm/mini-css-extract-plugin@0.9.0_webpack@4.47.0/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/.pnpm/css-loader@3.6.0_webpack@4.47.0/node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/.pnpm/vue-loader@15.11.1_99100e4f92fd92a2f7c7c086c9a74806/node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/.pnpm/postcss-loader@3.0.0/node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/.pnpm/cache-loader@4.1.0_webpack@4.47.0/node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/.pnpm/vue-loader@15.11.1_99100e4f92fd92a2f7c7c086c9a74806/node_modules/vue-loader/lib/index.js??vue-loader-options!./Product.vue?vue&type=style&index=0&id=2ab239e5&prod&scoped=true&lang=css\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('h1',[_vm._v(_vm._s(_vm.id ? '编辑商品' : '新增商品'))]),_c('el-form',{attrs:{\"label-width\":\"120px\"},on:{\"submit\":function($event){$event.preventDefault();return _vm.saveProduct.apply(null, arguments)}}},[_c('el-form-item',{attrs:{\"label\":\"商品分类\"}},[_c('el-select',{model:{value:(_vm.product.category),callback:function ($$v) {_vm.$set(_vm.product, \"category\", $$v)},expression:\"product.category\"}},_vm._l((_vm.fixedCategories),function(item){return _c('el-option',{key:item,attrs:{\"label\":item,\"value\":item}})}),1)],1),_c('el-form-item',{attrs:{\"label\":\"商品名称\"}},[_c('el-input',{model:{value:(_vm.product.name),callback:function ($$v) {_vm.$set(_vm.product, \"name\", $$v)},expression:\"product.name\"}})],1),_c('el-form-item',{attrs:{\"label\":\"商品价格\"}},[_c('el-input',{attrs:{\"type\":\"number\"},model:{value:(_vm.product.price),callback:function ($$v) {_vm.$set(_vm.product, \"price\", $$v)},expression:\"product.price\"}})],1),_c('el-form-item',{attrs:{\"label\":\"商品图片\"}},[_c('el-upload',{staticClass:\"avatar-uploader\",attrs:{\"action\":_vm.uploadUrl,\"headers\":_vm.getAuthHeaders(),\"show-file-list\":true,\"multiple\":true,\"on-success\":_vm.handleImageUpload,\"limit\":5}},[(_vm.product.image && _vm.product.image.length)?_c('div',{staticClass:\"image-preview\"},_vm._l((_vm.product.image),function(img,index){return _c('img',{key:index,staticClass:\"avatar-preview\",attrs:{\"src\":img}})}),0):_c('i',{staticClass:\"el-icon-plus avatar-uploader-icon\"})])],1),_c('el-form-item',{attrs:{\"label\":\"商品连接\"}},[_c('el-input',{model:{value:(_vm.product.url),callback:function ($$v) {_vm.$set(_vm.product, \"url\", $$v)},expression:\"product.url\"}})],1),_c('el-form-item',{attrs:{\"label\":\"商品描述\"}},[_c('mavon-editor',{ref:\"mavon\",attrs:{\"code_style\":\"monokai-sublime\",\"ishljs\":true},on:{\"imgAdd\":_vm.$imgAdd},model:{value:(_vm.product.description),callback:function ($$v) {_vm.$set(_vm.product, \"description\", $$v)},expression:\"product.description\"}})],1),_c('el-form-item',[_c('el-button',{attrs:{\"type\":\"primary\",\"native-type\":\"submit\"},on:{\"click\":_vm.saveProduct}},[_vm._v(\" 保存 \")])],1)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div>\r\n    <h1>{{ id ? '编辑商品' : '新增商品' }}</h1>\r\n    <el-form label-width=\"120px\" @submit.prevent=\"saveProduct\">\r\n      <el-form-item label=\"商品分类\">\r\n        <el-select v-model=\"product.category\">\r\n          <el-option\r\n            v-for=\"item in fixedCategories\"\r\n            :key=\"item\"\r\n            :label=\"item\"\r\n            :value=\"item\"\r\n          ></el-option>\r\n        </el-select>\r\n      </el-form-item>\r\n      <el-form-item label=\"商品名称\">\r\n        <el-input v-model=\"product.name\"></el-input>\r\n      </el-form-item>\r\n      <el-form-item label=\"商品价格\">\r\n        <el-input v-model=\"product.price\" type=\"number\"></el-input>\r\n      </el-form-item>\r\n      <el-form-item label=\"商品图片\">\r\n        <el-upload\r\n          class=\"avatar-uploader\"\r\n          :action=\"uploadUrl\"\r\n          :headers=\"getAuthHeaders()\"\r\n          :show-file-list=\"true\"\r\n          :multiple=\"true\"\r\n          :on-success=\"handleImageUpload\"\r\n          :limit=\"5\"\r\n        >\r\n          <div\r\n            v-if=\"product.image && product.image.length\"\r\n            class=\"image-preview\"\r\n          >\r\n            <img\r\n              v-for=\"(img, index) in product.image\"\r\n              :key=\"index\"\r\n              :src=\"img\"\r\n              class=\"avatar-preview\"\r\n            />\r\n          </div>\r\n          <i v-else class=\"el-icon-plus avatar-uploader-icon\"></i>\r\n        </el-upload>\r\n      </el-form-item>\r\n      <el-form-item label=\"商品连接\">\r\n        <el-input v-model=\"product.url\"></el-input>\r\n      </el-form-item>\r\n      <el-form-item label=\"商品描述\">\r\n        <mavon-editor\r\n          code_style=\"monokai-sublime\"\r\n          :ishljs=\"true\"\r\n          ref=\"mavon\"\r\n          v-model=\"product.description\"\r\n          @imgAdd=\"$imgAdd\"\r\n        ></mavon-editor>\r\n      </el-form-item>\r\n      <el-form-item>\r\n        <el-button type=\"primary\" native-type=\"submit\" @click=\"saveProduct\">\r\n          保存\r\n        </el-button>\r\n      </el-form-item>\r\n    </el-form>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { mavonEditor } from 'mavon-editor'\r\nimport 'mavon-editor/dist/css/index.css'\r\n\r\nexport default {\r\n  name: 'ProductForm',\r\n  components: {\r\n    mavonEditor,\r\n  },\r\n  props: {\r\n    id: {},\r\n  },\r\n  data() {\r\n    return {\r\n      product: {\r\n        name: '',\r\n        price: 0,\r\n        image: [], // 初始化为数组，支持多个图片\r\n        description: '',\r\n        category: '', // 初始化为字符串\r\n        url: '',\r\n      },\r\n      fixedCategories: ['CPU', 'GPU', '苹果', '协处理器', '其他'], // 固定的分类\r\n    }\r\n  },\r\n  methods: {\r\n    async saveProduct() {\r\n      try {\r\n        if (this.product._id) {\r\n          await this.$http.put(`/products/${this.product._id}`, this.product)\r\n        } else {\r\n          await this.$http.post('/products', this.product)\r\n        }\r\n\r\n        // 提示保存成功\r\n        this.$message({\r\n          type: 'success',\r\n          message: '保存成功',\r\n        })\r\n\r\n        // 可以在成功后跳转到产品列表\r\n        this.$router.push('/products/list');\r\n      } catch (error) {\r\n        // 在请求失败时提示错误信息\r\n        this.$message({\r\n          type: 'error',\r\n          message: '保存失败，请重试！', // 可以根据具体错误更新信息\r\n        })\r\n\r\n        // 如果需要，可以在这里输出错误的详细信息，方便调试\r\n        console.error('保存产品时发生错误:', error)\r\n      }\r\n    },\r\n    async fetchProduct(id) {\r\n      if (id) {\r\n        const res = await this.$http.get(`/products/${id}`)\r\n        this.product = res.data\r\n      }\r\n    },\r\n    // 上传图片成功后的处理函数\r\n    handleImageUpload(response, file, fileList) {\r\n      console.log(file.response) // 检查返回的数据结构\r\n      if (file.response && file.response.url) {\r\n        this.product.image = fileList.map((file) => file.response.url)\r\n      } else {\r\n        console.error('上传返回的响应数据不包含 url 属性')\r\n      }\r\n    },\r\n    //富文本图片上传\r\n    $imgAdd(pos, $file) {\r\n      const formData = new FormData()\r\n      formData.append('file', $file)\r\n      this.$http.post('/upload', formData).then((res) => {\r\n        this.$refs.mavon.$img2Url(pos, res.data.url)\r\n      })\r\n    },\r\n  },\r\n  created() {\r\n    this.fetchProduct(this.$route.params.id)\r\n    console.log(this.$route.params.id)\r\n  },\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.avatar-uploader-icon {\r\n  font-size: 28px;\r\n  color: #8c939d;\r\n}\r\n.avatar {\r\n  width: 100px;\r\n  height: 100px;\r\n  display: block;\r\n  border-radius: 50%;\r\n}\r\n.avatar-preview {\r\n  width: 100px;\r\n  height: 100px;\r\n  object-fit: cover;\r\n  margin-right: 10px;\r\n}\r\n.image-preview {\r\n  display: flex;\r\n  flex-wrap: wrap;\r\n}\r\n</style>\r\n","import mod from \"-!../../node_modules/.pnpm/cache-loader@4.1.0_webpack@4.47.0/node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/.pnpm/vue-loader@15.11.1_99100e4f92fd92a2f7c7c086c9a74806/node_modules/vue-loader/lib/index.js??vue-loader-options!./Product.vue?vue&type=script&lang=js\"; export default mod; export * from \"-!../../node_modules/.pnpm/cache-loader@4.1.0_webpack@4.47.0/node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/.pnpm/vue-loader@15.11.1_99100e4f92fd92a2f7c7c086c9a74806/node_modules/vue-loader/lib/index.js??vue-loader-options!./Product.vue?vue&type=script&lang=js\"","import { render, staticRenderFns } from \"./Product.vue?vue&type=template&id=2ab239e5&scoped=true\"\nimport script from \"./Product.vue?vue&type=script&lang=js\"\nexport * from \"./Product.vue?vue&type=script&lang=js\"\nimport style0 from \"./Product.vue?vue&type=style&index=0&id=2ab239e5&prod&scoped=true&lang=css\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/.pnpm/vue-loader@15.11.1_99100e4f92fd92a2f7c7c086c9a74806/node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"2ab239e5\",\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}