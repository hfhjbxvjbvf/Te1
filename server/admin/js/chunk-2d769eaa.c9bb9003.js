(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d769eaa"],{"5aa3":function(t,e,s){"use strict";s("ca94")},"5f09":function(t,e,s){"use strict";s.r(e);var l=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("h1",[t._v("轮播图列表")]),s("div",[s("el-checkbox",{staticStyle:{"margin-bottom":"10px"},attrs:{label:"全选"},on:{change:t.toggleSelectAll},model:{value:t.selectAll,callback:function(e){t.selectAll=e},expression:"selectAll"}},[t._v(" 全选 ")]),s("el-button",{staticStyle:{"margin-left":"85%"},attrs:{type:"primary"},on:{click:t.saveDateSelected}},[t._v(" 确定 ")])],1),s("el-table",{staticStyle:{width:"100%"},attrs:{data:t.products}},[s("el-table-column",{attrs:{label:"选择",width:"60"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("el-checkbox",{on:{change:t.updateSelected},model:{value:e.row.selected,callback:function(s){t.$set(e.row,"selected",s)},expression:"scope.row.selected"}})]}}])}),s("el-table-column",{attrs:{prop:"name",label:"商品名称",width:"180"}}),s("el-table-column",{attrs:{prop:"price",label:"商品价格",width:"180"}}),s("el-table-column",{attrs:{prop:"category",label:"商品分类",width:"180"}}),s("el-table-column",{attrs:{prop:"image",label:"商品图片",width:"180"},scopedSlots:t._u([{key:"default",fn:function(t){return[s("img",{staticStyle:{width:"50px",height:"50px"},attrs:{src:t.row.image[0],alt:"商品图片"}})]}}])}),s("el-table-column",{attrs:{label:"操作",width:"180"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("el-button",{attrs:{type:"danger"},on:{click:function(s){return t.deleteProductImg(e.row._id)}}},[t._v(" 删除 ")])]}}])})],1),s("el-pagination",{staticStyle:{"margin-top":"20px"},attrs:{"current-page":t.currentPage,"page-size":t.pageSize,total:t.totalProducts,layout:"total, prev, pager, next, jumper"},on:{"current-change":t.fetchSlideshowAndProducts}})],1)},a=[],c={data(){return{products:[],selectAll:!1,currentPage:1,pageSize:10,totalProducts:0}},methods:{async fetchSlideshowAndProducts(){try{const t=await this.$http.get("/slideshows"),e=t.data.slideshow,s=e.map(t=>t.productId);this.products=[];let l=0;while(l<s.length){const t=await this.$http.get("/products/"+s[l]),a={...t.data,_id:e[l]._id};this.products.push(a),l++}}catch(t){console.error("获取数据失败",t)}},async deleteProductImg(t){try{console.log("准备删除:",t),await this.$http.delete("/slideshows/"+t),this.$message.success("删除成功"),this.products=[],this.fetchSlideshowAndProducts()}catch(e){this.$message.error("删除失败，请重试！"),console.error("删除轮播图时发生错误:",e)}},updateSelected(){this.selectAll=this.products.every(t=>t.selected)},toggleSelectAll(t){this.products.forEach(e=>{e.selected=t})},async saveDateSelected(){try{await this.$http.post("/slideshows",this.products),this.$message.success("保存成功")}catch(t){this.$message.error("保存失败，请重试！"),console.error("保存失败:",t)}}},created(){this.fetchSlideshowAndProducts()}},o=c,r=(s("5aa3"),s("d34b")),i=Object(r["a"])(o,l,a,!1,null,"90d43b7e",null);e["default"]=i.exports},ca94:function(t,e,s){}}]);
//# sourceMappingURL=chunk-2d769eaa.c9bb9003.js.map