(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2960cd28"],{"20c1":function(t,e,r){},d2f1:function(t,e,r){"use strict";r.r(e);var o=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("h1",[t._v(t._s(t.id?"编辑商品":"新增商品"))]),r("el-form",{attrs:{"label-width":"120px"},on:{submit:function(e){return e.preventDefault(),t.saveProduct.apply(null,arguments)}}},[r("el-form-item",{attrs:{label:"商品分类"}},[r("el-select",{model:{value:t.product.category,callback:function(e){t.$set(t.product,"category",e)},expression:"product.category"}},t._l(t.fixedCategories,(function(t){return r("el-option",{key:t,attrs:{label:t,value:t}})})),1)],1),r("el-form-item",{attrs:{label:"商品名称"}},[r("el-input",{model:{value:t.product.name,callback:function(e){t.$set(t.product,"name",e)},expression:"product.name"}})],1),r("el-form-item",{attrs:{label:"商品价格"}},[r("el-input",{attrs:{type:"number"},model:{value:t.product.price,callback:function(e){t.$set(t.product,"price",e)},expression:"product.price"}})],1),r("el-form-item",{attrs:{label:"商品图片"}},[r("el-upload",{staticClass:"avatar-uploader",attrs:{action:t.uploadUrl,headers:t.getAuthHeaders(),"show-file-list":!0,multiple:!0,"on-success":t.handleImageUpload,limit:5}},[t.product.image&&t.product.image.length?r("div",{staticClass:"image-preview"},t._l(t.product.image,(function(t,e){return r("img",{key:e,staticClass:"avatar-preview",attrs:{src:t}})})),0):r("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1),r("el-form-item",{attrs:{label:"商品连接"}},[r("el-input",{model:{value:t.product.url,callback:function(e){t.$set(t.product,"url",e)},expression:"product.url"}})],1),r("el-form-item",{attrs:{label:"商品描述"}},[r("mavon-editor",{ref:"mavon",attrs:{code_style:"monokai-sublime",ishljs:!0},on:{imgAdd:t.$imgAdd},model:{value:t.product.description,callback:function(e){t.$set(t.product,"description",e)},expression:"product.description"}})],1),r("el-form-item",[r("el-button",{attrs:{type:"primary","native-type":"submit"},on:{click:t.saveProduct}},[t._v(" 保存 ")])],1)],1)],1)},a=[],s=r("00ec"),i=(r("3497"),{name:"ProductForm",components:{mavonEditor:s["mavonEditor"]},props:{id:{}},data(){return{product:{name:"",price:0,image:[],description:"",category:"",url:""},fixedCategories:["CPU","GPU","苹果","协处理器","其他"]}},methods:{async saveProduct(){try{this.id?await this.$http.put("/products/"+this.id,this.product):await this.$http.post("/products",this.product),this.$message({type:"success",message:"保存成功"})}catch(t){this.$message({type:"error",message:"保存失败，请重试！"}),console.error("保存产品时发生错误:",t)}},async fetchProduct(t){if(t){const e=await this.$http.get("/products/"+t);this.product=e.data}},handleImageUpload(t,e,r){console.log(e.response),e.response&&e.response.url?this.product.image=r.map(t=>t.response.url):console.error("上传返回的响应数据不包含 url 属性")},$imgAdd(t,e){const r=new FormData;r.append("file",e),this.$http.post("/upload",r).then(e=>{this.$refs.mavon.$img2Url(t,e.data.url)})}},created(){this.fetchProduct(this.$route.params.id),console.log(this.$route.params.id)}}),c=i,l=(r("d547"),r("d34b")),n=Object(l["a"])(c,o,a,!1,null,"22e2f52a",null);e["default"]=n.exports},d547:function(t,e,r){"use strict";r("20c1")}}]);
//# sourceMappingURL=chunk-2960cd28.a4898888.js.map